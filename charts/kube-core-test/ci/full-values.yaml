# Full values â€” every feature enabled for maximum test coverage
alpha:
  enabled: true
  nameOverride: ""
  fullnameOverride: ""
  replicaCount: 3
  app:
    image:
      repository: myapp/alpha
      pullPolicy: Always
      tag: "2.0.0"
    ports:
      - name: http
        containerPort: 8080
        protocol: TCP
      - name: metrics
        containerPort: 9090
        protocol: TCP
    env:
      - name: APP_ENV
        value: "dev"
      - name: SECRET_KEY
        valueFrom:
          secretKeyRef:
            name: app-secret
            key: secret-key
    envFrom:
      - configMapRef:
          name: app-config
      - secretRef:
          name: app-secrets
    command:
      - /bin/sh
      - -c
    args:
      - "start-server --port 8080"
  initContainers:
    - name: init-db
      image: busybox:1.36
      command: ["sh", "-c", "echo init"]
      securityContext:
        allowPrivilegeEscalation: false
        readOnlyRootFilesystem: true
        capabilities:
          drop:
            - ALL
  sidecars:
    - name: log-shipper
      image: fluent/fluent-bit:2.0
      securityContext:
        allowPrivilegeEscalation: false
        readOnlyRootFilesystem: true
        capabilities:
          drop:
            - ALL
      resources:
        limits:
          memory: "128Mi"
          cpu: "100m"
        requests:
          memory: "64Mi"
          cpu: "50m"
  imagePullSecrets:
    - name: regcred
  serviceAccount:
    create: true
    automount: false
    annotations:
      eks.amazonaws.com/role-arn: "arn:aws:iam::role/my-role"
    name: "alpha-sa"
  rbac:
    create: true
    role:
      annotations:
        custom: "role-annotation"
      labels:
        custom: "role-label"
      rules:
        - apiGroups: [""]
          resources: ["pods", "configmaps"]
          verbs: ["get", "list", "watch"]
    roleBinding:
      annotations:
        custom: "rb-annotation"
      labels:
        custom: "rb-label"
    clusterRole:
      enabled: false
    clusterRoleBinding:
      enabled: false
  deploymentAnnotations:
    deployment.custom/annotation: "true"
  deploymentLabels:
    deployment.custom/label: "true"
  podAnnotations:
    pod.custom/annotation: "true"
  podLabels:
    pod.custom/label: "true"
  podSecurityContext:
    runAsNonRoot: true
    runAsUser: 1000
    runAsGroup: 1000
    fsGroup: 1000
    fsGroupChangePolicy: OnRootMismatch
    seccompProfile:
      type: RuntimeDefault
  enableServiceLinks: false
  securityContext:
    allowPrivilegeEscalation: false
    readOnlyRootFilesystem: true
    capabilities:
      drop:
        - ALL
  service:
    enabled: true
    type: ClusterIP
    ports:
      - name: http
        port: 80
        targetPort: http
        protocol: TCP
      - name: metrics
        port: 9090
        targetPort: metrics
        protocol: TCP
    annotations:
      service.beta.kubernetes.io/aws-load-balancer-type: "nlb"
  configmap:
    enabled: true
    name: ""
    annotations:
      configmap.custom: "true"
    labels:
      configmap.custom: "true"
    data:
      config.yaml: |
        server:
          port: 8080
      settings.json: '{"debug": true}'
    binaryData: {}
    mount:
      enabled: true
      mountPath: "/etc/config"
      readOnly: true
      subPath: ""
      items:
        - key: config.yaml
          path: config.yaml
  ingress:
    enabled: true
    className: "nginx"
    annotations:
      cert-manager.io/cluster-issuer: "letsencrypt"
    hosts:
      - host: alpha.dev.example.com
        paths:
          - path: /
            pathType: Prefix
    tls:
      - secretName: alpha-tls
        hosts:
          - alpha.dev.example.com
  httpRoute:
    enabled: false
    annotations: {}
    parentRefs: []
    hostnames: []
    rules: []
  resources:
    limits:
      cpu: "500m"
      memory: "256Mi"
    requests:
      cpu: "100m"
      memory: "128Mi"
  livenessProbe:
    httpGet:
      path: /healthz
      port: http
    initialDelaySeconds: 15
    periodSeconds: 10
  readinessProbe:
    httpGet:
      path: /readyz
      port: http
    initialDelaySeconds: 5
    periodSeconds: 5
  startupProbe:
    httpGet:
      path: /healthz
      port: http
    failureThreshold: 30
    periodSeconds: 10
  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 10
    targetCPUUtilizationPercentage: 75
    targetMemoryUtilizationPercentage: 80
    behavior:
      scaleDown:
        stabilizationWindowSeconds: 300
        policies:
          - type: Percent
            value: 50
            periodSeconds: 60
        selectPolicy: Max
      scaleUp:
        stabilizationWindowSeconds: 0
        policies:
          - type: Percent
            value: 100
            periodSeconds: 30
        selectPolicy: Max
    customMetrics: []
    containerMetrics: []
  volumes:
    - name: cache
      emptyDir: {}
    - name: secret-vol
      secret:
        secretName: app-secret
  volumeMounts:
    - name: cache
      mountPath: /tmp/cache
    - name: secret-vol
      mountPath: /etc/secrets
      readOnly: true
  persistentVolumes:
    - name: data
      mountPath: /data
      storageClassName: gp3
      accessModes:
        - ReadWriteOnce
      storage: "10Gi"
  nodeSelector:
    kubernetes.io/os: linux
  tolerations:
    - key: "dedicated"
      operator: "Equal"
      value: "alpha"
      effect: "NoSchedule"
  affinity:
    podAntiAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
        - weight: 100
          podAffinityTerm:
            labelSelector:
              matchExpressions:
                - key: app.kubernetes.io/name
                  operator: In
                  values:
                    - alpha
            topologyKey: kubernetes.io/hostname
  topologySpreadConstraints:
    - maxSkew: 1
      topologyKey: topology.kubernetes.io/zone
      whenUnsatisfiable: DoNotSchedule
      labelSelector:
        matchLabels:
          app.kubernetes.io/name: alpha
  podDisruptionBudget:
    enabled: true
    minAvailable: 1
    maxUnavailable: null
    annotations: {}
    labels: {}
  serviceMonitor:
    enabled: true
    annotations: {}
    labels:
      release: prometheus
    jobLabel: ""
    selector: {}
    endpoints:
      - port: metrics
        interval: 30s
        scrapeTimeout: 10s
        path: /metrics
        scheme: http
        honorLabels: false
        honorTimestamps: true
  prometheusRule:
    enabled: true
    prometheusLabel: "kube-prometheus"
    rules:
      - name: alpha-alerts
        groups:
          - name: alpha
            rules:
              - alert: HighErrorRate
                expr: rate(http_requests_total{status=~"5.."}[5m]) > 0.1
                for: 5m
                labels:
                  severity: warning
                annotations:
                  summary: High error rate detected
              - record: job:http_requests_total:rate5m
                expr: rate(http_requests_total[5m])
